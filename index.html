<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Multi-Model Compare</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    /* Simple layout */
    #menuToggle {
      position: absolute;
      top: 10px;
      left: 10px;
      cursor: pointer;
      padding: 5px 10px;
      background: #ccc;
      border: none;
      border-radius: 4px;
    }
    #menu {
      display: none;
      position: absolute;
      top: 50px;
      left: 10px;
      background: #f5f5f5;
      border: 1px solid #ddd;
      padding: 1rem;
      width: 300px;
      border-radius: 4px;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    #apiKeyStatus {
      color: green;
      margin: 0.5rem 0;
    }
    #chatWindow {
      margin: 60px 10px 60px 10px;
      padding: 1rem;
      border: 1px solid #ddd;
      height: 400px;
      overflow-y: auto;
    }
    .userMessage {
      background: #36d6b5;
      color: #fff;
      padding: 8px;
      border-radius: 4px;
      margin-bottom: 5px;
    }
    .assistantMessage {
      background: #eaeaea;
      padding: 8px;
      border-radius: 4px;
      margin-bottom: 5px;
    }
    .geminiResponse {
      border-left: 6px solid #eb9a00; /* Distinguish each vendor if you like */
      padding-left: 5px;
    }
    .openaiResponse {
      border-left: 6px solid #0066cc;
      padding-left: 5px;
    }
    .grokResponse {
      border-left: 6px solid #7b2e90;
      padding-left: 5px;
    }
    #inputArea {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #f5f5f5;
      padding: 1rem;
      border-top: 1px solid #ddd;
      display: flex;
      gap: 0.5rem;
    }
    #userInput {
      flex: 1;
      padding: 0.5rem;
      font-size: 1rem;
    }
    #sendButton {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      background: #36d6b5;
      color: #fff;
      border-radius: 4px;
    }
    /* Simple model lists */
    .modelList {
      margin-top: 1rem;
      padding-left: 1rem;
    }
  </style>
</head>
<body>
<button id="menuToggle" onclick="toggleMenu()">Menu</button>

<div id="menu">
  <h3>Settings</h3>
  <!-- Gemini API Key -->
  <label for="geminiApiKeyInput">Gemini API Key:</label>
  <input type="password" id="geminiApiKeyInput" />
  <button onclick="toggleVisibility('geminiApiKeyInput')">Show</button>

  <!-- OpenAI API Key -->
  <label for="openAiApiKeyInput">OpenAI API Key:</label>
  <input type="password" id="openAiApiKeyInput" />
  <button onclick="toggleVisibility('openAiApiKeyInput')">Show</button>

  <!-- Grok API Key -->
  <label for="grokApiKeyInput">Grok API Key:</label>
  <input type="password" id="grokApiKeyInput" />
  <button onclick="toggleVisibility('grokApiKeyInput')">Show</button>

  <hr />

  <!-- Model Selections -->
  <h4>Select Models</h4>

  <p><strong>Gemini:</strong></p>
  <div class="modelList">
    <input type="checkbox" id="geminiModel_1" value="gemini-1.5-flash" /> gemini-1.5-flash<br />
    <input type="checkbox" id="geminiModel_2" value="gemini-2.0-flash" /> gemini-2.0-flash
  </div>

  <p><strong>OpenAI:</strong></p>
  <div class="modelList">
    <input type="checkbox" id="openAiModel_gpt35" value="gpt-3.5-turbo" /> GPT-3.5 Turbo <br />
    <input type="checkbox" id="openAiModel_gpt4" value="gpt-4" /> GPT-4 <br />
    <input type="checkbox" id="openAiModel_gpt432k" value="gpt-4-32k" /> GPT-4 32k
  </div>

  <p><strong>Grok:</strong></p>
  <div class="modelList">
    <input type="checkbox" id="grokModel_beta" value="grok-beta" /> grok-beta <br />
    <input type="checkbox" id="grokModel_latest" value="grok-latest" /> grok-latest
  </div>

  <hr />

  <button onclick="saveSettings()">Save</button>
  <p id="apiKeyStatus"></p>
</div>

<div id="chatWindow"></div>

<div id="inputArea">
  <input
    type="text"
    id="userInput"
    placeholder="Type your message here"
    onkeypress="handleKeyPress(event)"
  />
  <button id="sendButton" onclick="sendMessage()">Send</button>
</div>

<script>
/* ------------------------------
   GLOBAL STATE
------------------------------ */
let geminiApiKey = "";
let openAiApiKey = "";
let grokApiKey = "";

// We'll store selected models in arrays
// e.g. selectedOpenAiModels = ["gpt-3.5-turbo", "gpt-4"];
let selectedGeminiModels = [];
let selectedOpenAiModels = [];
let selectedGrokModels = [];

/* ------------------------------
   ON LOAD
------------------------------ */
window.onload = function () {
  // Load stored keys
  geminiApiKey = localStorage.getItem("geminiApiKey") || "";
  openAiApiKey = localStorage.getItem("openAiApiKey") || "";
  grokApiKey = localStorage.getItem("grokApiKey") || "";

  document.getElementById("geminiApiKeyInput").value = geminiApiKey;
  document.getElementById("openAiApiKeyInput").value = openAiApiKey;
  document.getElementById("grokApiKeyInput").value = grokApiKey;

  // Load selected models
  selectedGeminiModels = JSON.parse(localStorage.getItem("selectedGeminiModels") || "[]");
  selectedOpenAiModels = JSON.parse(localStorage.getItem("selectedOpenAiModels") || "[]");
  selectedGrokModels = JSON.parse(localStorage.getItem("selectedGrokModels") || "[]");

  // Check the corresponding checkboxes
  // Gemini
  if (selectedGeminiModels.includes("gemini-1.5-flash")) {
    document.getElementById("geminiModel_1").checked = true;
  }
  if (selectedGeminiModels.includes("gemini-2.0-flash")) {
    document.getElementById("geminiModel_2").checked = true;
  }
  // OpenAI
  if (selectedOpenAiModels.includes("gpt-3.5-turbo")) {
    document.getElementById("openAiModel_gpt35").checked = true;
  }
  if (selectedOpenAiModels.includes("gpt-4")) {
    document.getElementById("openAiModel_gpt4").checked = true;
  }
  if (selectedOpenAiModels.includes("gpt-4-32k")) {
    document.getElementById("openAiModel_gpt432k").checked = true;
  }
  // Grok
  if (selectedGrokModels.includes("grok-beta")) {
    document.getElementById("grokModel_beta").checked = true;
  }
  if (selectedGrokModels.includes("grok-latest")) {
    document.getElementById("grokModel_latest").checked = true;
  }
};

/* ------------------------------
   MENU / SETTINGS
------------------------------ */
function toggleMenu() {
  const menu = document.getElementById("menu");
  if (menu.style.display === "block") {
    menu.style.display = "none";
  } else {
    menu.style.display = "block";
  }
}

// Toggle password visibility
function toggleVisibility(inputId) {
  const input = document.getElementById(inputId);
  input.type = input.type === "password" ? "text" : "password";
}

// Save settings to localStorage
function saveSettings() {
  // Grab user input
  geminiApiKey = document.getElementById("geminiApiKeyInput").value;
  openAiApiKey = document.getElementById("openAiApiKeyInput").value;
  grokApiKey = document.getElementById("grokApiKeyInput").value;

  localStorage.setItem("geminiApiKey", geminiApiKey);
  localStorage.setItem("openAiApiKey", openAiApiKey);
  localStorage.setItem("grokApiKey", grokApiKey);

  // Build arrays of selected models
  const gemini1 = document.getElementById("geminiModel_1");
  const gemini2 = document.getElementById("geminiModel_2");
  selectedGeminiModels = [];
  if (gemini1.checked) selectedGeminiModels.push(gemini1.value);
  if (gemini2.checked) selectedGeminiModels.push(gemini2.value);
  localStorage.setItem("selectedGeminiModels", JSON.stringify(selectedGeminiModels));

  const openAi35 = document.getElementById("openAiModel_gpt35");
  const openAi4 = document.getElementById("openAiModel_gpt4");
  const openAi432k = document.getElementById("openAiModel_gpt432k");
  selectedOpenAiModels = [];
  if (openAi35.checked) selectedOpenAiModels.push(openAi35.value);
  if (openAi4.checked) selectedOpenAiModels.push(openAi4.value);
  if (openAi432k.checked) selectedOpenAiModels.push(openAi432k.value);
  localStorage.setItem("selectedOpenAiModels", JSON.stringify(selectedOpenAiModels));

  const grokBeta = document.getElementById("grokModel_beta");
  const grokLatest = document.getElementById("grokModel_latest");
  selectedGrokModels = [];
  if (grokBeta.checked) selectedGrokModels.push(grokBeta.value);
  if (grokLatest.checked) selectedGrokModels.push(grokLatest.value);
  localStorage.setItem("selectedGrokModels", JSON.stringify(selectedGrokModels));

  // Notify user
  document.getElementById("apiKeyStatus").innerText = "Settings saved!";
  setTimeout(() => {
    document.getElementById("apiKeyStatus").innerText = "";
  }, 1500);
  toggleMenu();
}

/* ------------------------------
   CHAT LOGIC
------------------------------ */
// Handle Enter key
function handleKeyPress(event) {
  if (event.key === "Enter") {
    sendMessage();
  }
}

// Send message
function sendMessage() {
  const userInputEl = document.getElementById("userInput");
  const userInput = userInputEl.value.trim();
  if (!userInput) return;

  // Display user message
  appendMessage("user", userInput);

  // Clear input
  userInputEl.value = "";

  // If we have an API key, call each selected model
  // GEMINI
  if (geminiApiKey && selectedGeminiModels.length) {
    selectedGeminiModels.forEach((model) => {
      sendGeminiRequest(userInput, model);
    });
  }

  // OPENAI
  if (openAiApiKey && selectedOpenAiModels.length) {
    selectedOpenAiModels.forEach((model) => {
      sendOpenAiRequest(userInput, model);
    });
  }

  // GROK
  if (grokApiKey && selectedGrokModels.length) {
    selectedGrokModels.forEach((model) => {
      sendGrokRequest(userInput, model);
    });
  }
}

/* ------------------------------
   APPEND MESSAGE TO CHAT
------------------------------ */
function appendMessage(role, message, type = "") {
  const chatWindow = document.getElementById("chatWindow");
  const messageElement = document.createElement("p");

  if (role === "user") {
    messageElement.classList.add("userMessage");
  } else {
    messageElement.classList.add("assistantMessage");
    if (type) {
      messageElement.classList.add(`${type}Response`);
    }
  }
  messageElement.innerText = message;
  chatWindow.appendChild(messageElement);

  // Auto-scroll
  chatWindow.scrollTop = chatWindow.scrollHeight;
}

/* ------------------------------
   API REQUESTS
------------------------------ */
// 1) GEMINI
function sendGeminiRequest(userInput, model) {
  // Example: gemini-1.5-flash => use the path /v1beta/models/gemini-1.5-flash:generateContent
  const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${geminiApiKey}`;
  fetch(url, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      contents: [
        { parts: [{ text: userInput }] }
      ]
    }),
  })
    .then((response) => response.json())
    .then((data) => {
      const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "No response";
      appendMessage("assistant", text, "gemini");
    })
    .catch((error) => {
      appendMessage("assistant", `Error: ${error.message}`, "gemini");
    });
}

// 2) OPENAI
function sendOpenAiRequest(userInput, model) {
  const url = "https://api.openai.com/v1/chat/completions";
  fetch(url, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${openAiApiKey}`,
    },
    body: JSON.stringify({
      model: model, // e.g. "gpt-3.5-turbo", "gpt-4"
      messages: [{ role: "user", content: userInput }],
      temperature: 0.7,
    }),
  })
    .then((response) => response.json())
    .then((data) => {
      const text = data.choices?.[0]?.message?.content || "No response";
      appendMessage("assistant", text, "openai");
    })
    .catch((error) => {
      appendMessage("assistant", `Error: ${error.message}`, "openai");
    });
}

// 3) GROK
function sendGrokRequest(userInput, model) {
  const url = "https://api.x.ai/v1/chat/completions";
  fetch(url, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${grokApiKey}`,
    },
    body: JSON.stringify({
      messages: [{ role: "user", content: userInput }],
      model: model, // e.g. "grok-beta"
      temperature: 0.7,
    }),
  })
    .then((response) => response.json())
    .then((data) => {
      const text = data.choices?.[0]?.message?.content || "No response";
      appendMessage("assistant", text, "grok");
    })
    .catch((error) => {
      appendMessage("assistant", `Error: ${error.message}`, "grok");
    });
}
</script>
</body>
</html>
